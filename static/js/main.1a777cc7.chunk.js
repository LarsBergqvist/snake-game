(this["webpackJsonpsnake-game"]=this["webpackJsonpsnake-game"]||[]).push([[0],{12:function(e,t,n){},26:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),c=n(7),a=n.n(c),o=(n(26),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),c(e),a(e)}))}),s=n(4),u="INIT_GAME",h="HIGHSCORE_LIST_LOADED",d="NAME_CHANGED",g="NAME_SUBMITTED",l="HIGHSCORE_LIST_SAVED",b="MOVE_SNAKE",m="CHANGE_DIRECTION";function p(e){return{type:m,direction:e}}function j(){return{type:b}}function f(e,t,n){var r=Object(s.a)(n.results).map((function(e){return{id:e.id,score:e.score}}));r.push({id:e,score:t}),r.sort((function(e,t){return function(e,t){return e.score>=t.score?-1:e.score<t.score?1:void 0}(e,t)}));var i=r.findIndex((function(t){return t.id===e}));return i>-1&&i+1<=n.maxSize?i:-1}function O(e,t,n){for(var r=[],i=0;i<e*e;i++){var c=Math.floor(i/e),a=i%e;0===a||a===e-1||0===c||c===e-1?r.push(1):r.push(0)}n&&(r[n.y*e+n.x]=2);for(var o=0;o<t.length;o++){var s=t[o].x,u=t[o].y*e+s;u<e*e&&(r[u]=3+o)}return r}function v(e,t,n){var r=3;n>30?r=1:n>20&&(r=2);for(var i=!1,c=void 0,a=function(){var n=Math.floor(Math.random()*(e-2*r)+r),a=Math.floor(Math.random()*(e-2*r)+r);-1===t.findIndex((function(e){return e.x===n&&e.y===a}))&&(i=!0,c={x:n,y:a})};!i;)a();return c}function S(e,t){return!(t===e||2===t&&1===e||1===t&&2===e||3===t&&4===e||4===t&&3===e)}function x(e,t){var n=t.x,r=t.y;return 3===e?r--:4===e?r++:2===e?n--:n++,{x:n,y:r}}var w=[{name:"Snake Game",size:30,highscorelistid:"60ec9a48e10c1eec66e4dadb"}],N=n(35),y={points:0,gameStarted:!1,gameComplete:!1,gridViewModel:[],size:void 0,gameId:void 0,gameName:void 0,direction:1,snake:void 0,food:void 0,highScoreList:void 0,highScorePosition:-1,userName:void 0,userId:void 0,highScoreListSaved:!1,directionsQueue:[],nameSubmitted:!1};var k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:var n=w[t.gameId].size,r=[{x:3,y:1},{x:2,y:1},{x:1,y:1},{x:0,y:5}],i=r.map((function(e){return{x:e.x+1,y:n/2}})),c=v(n,i,0);return Object.assign({},y,{gameId:t.gameId,size:n,gameName:w[t.gameId].name,imageNumber:t.imageNumber,highScoreListId:w[t.gameId].highscorelistid,food:c,gridViewModel:O(w[t.gameId].size,i,c),gameStarted:!0,snake:i,nameSubmitted:!1});case m:if(t.direction===e.directionsQueue[0])return e;var a=Object(s.a)(e.directionsQueue);return a.length>=3&&a.pop(),a.push(t.direction),Object.assign({},e,{directionsQueue:a});case b:if(e.gameComplete||!e.gameStarted)return e;var o=Object(s.a)(e.directionsQueue),p=o.shift(),j=e.direction;if(p){if(!S(j,p))return Object.assign({},e,{directionsQueue:o});j=p}var k=Object(s.a)(e.snake),C=x(j,k[0]),I=e.gridViewModel[C.y*e.size+C.x];if(1===I||I>=3){if(e.highScoreList){var L=Object(N.a)(),E=f(L,e.points,e.highScoreList);return E>-1?Object.assign({},e,{highScorePosition:E+1,gameComplete:!0,userId:L,directionsQueue:o}):Object.assign({},e,{highScorePosition:E+1,gameComplete:!0,directionsQueue:o})}return Object.assign({},e,{gameComplete:!0,directionsQueue:o})}var D=e.gameLoopInterval,M=e.points,T=2===I;T?M++:k.pop(),k.unshift(C);var z=T?v(e.size,k,e.points):Object.assign({},e.food),P=O(e.size,k,z);return Object.assign({},e,{snake:k,gridViewModel:P,food:z,points:M,direction:j,directionsQueue:o,gameLoopInterval:D});case h:return Object.assign({},e,{highScoreList:t.highScoreList});case d:return Object.assign({},e,{userName:t.name});case g:return Object.assign({},e,{nameSubmitted:!0});case l:return Object.assign({},e,{highScoreListSaved:!0,highScoreList:t.highScoreList});default:return e}},C=n(3),I=n(9),L=n(15),E=n(16),D=n(17),M=n(21),T=n(19),z=(n(12),n(0)),P=function(e){if(!e.highScoreList)return Object(z.jsx)(z.Fragment,{});var t=e.highScoreList.results.map((function(t,n){var r="";return e.userId&&t.id===e.userId&&(r="user-row-in-highscore"),Object(z.jsxs)("tr",{className:r,children:[Object(z.jsxs)("td",{children:["#",n+1]}),Object(z.jsx)("td",{children:t.userName}),Object(z.jsx)("td",{className:"date-column",children:new Date(t.utcDateTime).toLocaleDateString()}),Object(z.jsx)("td",{children:t.score})]},n+1)}));return Object(z.jsx)(z.Fragment,{children:Object(z.jsxs)("div",{children:[Object(z.jsx)("h3",{children:e.highScoreList.name}),Object(z.jsxs)("table",{className:"highscoretable",children:[Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{children:"Position"}),Object(z.jsx)("th",{children:"Name"}),Object(z.jsx)("th",{className:"date-column",children:"Date"}),Object(z.jsx)("th",{children:e.highScoreList.unit})]})}),Object(z.jsx)("tbody",{children:t})]})]})})},_=n(20),A=n(2),V=n.n(A),G=n(5);function Q(e,t){return F.apply(this,arguments)}function F(){return(F=Object(G.a)(V.a.mark((function e(t,n){var r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=setInterval((function(){n().gameComplete?clearInterval(r):t(j())}),100);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){return q.apply(this,arguments)}function q(){return(q=Object(G.a)(V.a.mark((function e(t,n){var r,i;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=="https://highscore-service-lb-api.azurewebsites.net".length){e.next=2;break}return e.abrupt("return");case 2:return r="".concat("https://highscore-service-lb-api.azurewebsites.net","/highscore-lists/").concat(n().highScoreListId),e.prev=3,e.next=6,B(r);case 6:i=e.sent,t({type:h,highScoreList:i}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Network request failed");case 13:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function R(e,t){return U.apply(this,arguments)}function U(){return(U=Object(G.a)(V.a.mark((function e(t,n){var r,i,c,a,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=="https://highscore-service-lb-api.azurewebsites.net".length){e.next=2;break}return e.abrupt("return");case 2:if(r="".concat("https://highscore-service-lb-api.azurewebsites.net","/highscore-lists/").concat(n().highScoreListId,"/game-results"),(i=n()).userName&&0!==i.userName.length&&!i.nameSubmitted){e.next=6;break}return e.abrupt("return");case 6:return t({type:g}),c={userName:i.userName,score:i.points,id:i.userId},e.prev=8,e.next=11,K(r,c);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(8),console.error("Network request failed3"),e.abrupt("return");case 17:return a="".concat("https://highscore-service-lb-api.azurewebsites.net","/highscore-lists/").concat(n().highScoreListId),e.next=20,B(a);case 20:o=e.sent,t({type:l,highScoreList:o});case 22:case"end":return e.stop()}}),e,null,[[8,13]])})))).apply(this,arguments)}function B(e){return J.apply(this,arguments)}function J(){return(J=Object(G.a)(V.a.mark((function e(t){var n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{headers:{ApiKey:"".concat("fe9f18bf-2d7b-4bdb-954e-4cfd83d66217")}});case 3:if((n=e.sent).ok){e.next=6;break}throw Error("Network request failed");case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(0),Error("Network request failed");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function K(e,t){return X.apply(this,arguments)}function X(){return(X=Object(G.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"POST",headers:{"Content-Type":"application/json",ApiKey:"".concat("fe9f18bf-2d7b-4bdb-954e-4cfd83d66217")},body:JSON.stringify(n)});case 3:if(e.sent.ok){e.next=6;break}throw Error("Network request failed");case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),Error("Network request failed");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}var Y=Object(C.b)((function(e){return{highScorePosition:e.highScorePosition,highScoreList:e.highScoreList,nameSubmitted:e.nameSubmitted}}),(function(e){return{onSubmitNameToHighScore:function(){e(R)},onNameChanged:function(t){e(function(e){return{type:d,name:e}}(t))}}}))((function(e){var t=Object(r.useState)(""),n=Object(_.a)(t,2),i=n[0],c=n[1];return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)("div",{children:["YOU MADE IT TO #",e.highScorePosition," on the leaderboard!"]}),"Enter your name:",Object(z.jsx)("input",{type:"text",minLength:"3",maxLength:"25",required:!0,onChange:function(t){c(t.target.value),e.onNameChanged(t.target.value)},disabled:e.nameSubmitted}),Object(z.jsx)("div",{children:i.length>=3&&i.length<=25&&Object(z.jsx)("button",{className:"game-button",onClick:function(){return e.onSubmitNameToHighScore(i)},disabled:e.nameSubmitted,children:"Submit"})})]})})),W=function(e){return e.gameStarted?e.gameComplete?Object(z.jsxs)("div",{className:"game-status",children:[Object(z.jsx)("div",{children:Object(z.jsx)("b",{children:"GAME OVER!"})}),Object(z.jsxs)("div",{children:["You got ",e.points," points"]}),e.highScorePosition>0&&!e.highScoreListSaved&&Object(z.jsx)(Y,{}),e.highScorePosition>0&&e.highScoreListSaved&&Object(z.jsx)(P,{highScoreList:e.highScoreList,userId:e.userId}),Object(z.jsx)("button",{className:"game-button",onClick:function(){return e.onInitGame(0)},children:"Restart"})]}):Object(z.jsxs)("div",{className:"game-status",children:["Score: ",Object(z.jsx)("b",{children:e.points}),Object(z.jsx)("div",{className:"game-instructions",children:Object(z.jsx)("div",{children:"Use swipe or arrow keys to change direction"})})]}):Object(z.jsx)("div",{children:Object(z.jsx)("button",{className:"game-button",onClick:function(){return e.onInitGame(0)},children:"Start game"})})};W.defaultProps={gameStarted:!1};var Z=Object(C.b)((function(e){return{points:e.points,gameComplete:e.gameComplete,highScorePosition:e.highScorePosition,highScoreListSaved:e.highScoreListSaved,highScoreList:e.highScoreList,userId:e.userId,gameStarted:e.gameStarted}}),(function(e){return{onInitGame:function(t){e(function(e){return{type:u,gameId:e}}(t)),e(H),e(Q)}}}))(W),$=n(10),ee=function(e){return 0===e?{backgroundColor:"white",outline:"1px solid lightgray",outlineOffset:"-1px"}:e>=3?{backgroundColor:"rgba(0,0,0, ".concat(Math.max(.2,1/(.6*(e-2))),")")}:2===e?{backgroundColor:"green"}:1===e?{backgroundColor:"red"}:void 0},te=function(e){var t=e.id;return Object(z.jsx)("div",{className:"tile",style:ee(t)})},ne=n(18),re=Object(C.b)((function(e){return{gridViewModel:e.gridViewModel,size:e.size}}),(function(e){return{onChangeDirection:function(t){e(p(t))}}}))((function(e){var t=300/e.size,n={width:"".concat(e.size*t,"px")},r={gridTemplateColumns:"repeat(".concat(e.size,",").concat(t,"px)")},i=Object(ne.useSwipeable)(Object($.a)({onSwipedRight:function(){return e.onChangeDirection(1)},onSwipedLeft:function(){return e.onChangeDirection(2)},onSwipedUp:function(){return e.onChangeDirection(3)},onSwipedDown:function(){return e.onChangeDirection(4)}},{delta:5,preventDefaultTouchmoveEvent:!0,trackTouch:!0,trackMouse:!1,rotationAngle:0}));return Object(z.jsx)("div",Object($.a)(Object($.a)({},i),{},{className:"tile-wrapper",style:n,children:Object(z.jsx)("div",{className:"tile-container",style:r,children:e.gridViewModel.map((function(e,t){return Object(z.jsx)(te,{id:e},t)}))})}))})),ie=function(e){return Object(z.jsx)(z.Fragment,{children:Object(z.jsx)("div",{children:Object(z.jsx)("h2",{children:e.gameName})})})},ce=function(e){Object(M.a)(n,e);var t=Object(T.a)(n);function n(e){return Object(E.a)(this,n),t.call(this,e)}return Object(D.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",(function(t){switch(t.keyCode){case 38:e.props.onChangeDirection(3);break;case 40:e.props.onChangeDirection(4);break;case 37:e.props.onChangeDirection(2);break;case 39:e.props.onChangeDirection(1)}!e.props.gameComplete&&e.props.gameStarted&&t.preventDefault()}),!1)}},{key:"render",value:function(){return Object(z.jsxs)("div",{className:"game",children:[Object(z.jsx)(ie,{gameName:this.props.gameName}),Object(z.jsx)(Z,{}),Object(z.jsx)(re,{})]})}}]),n}(i.a.Component);ce.defaultProps={gameStarted:!1,gameComplete:!1};var ae=Object(C.b)((function(e){return{gameName:e.gameName,gameComplete:e.gameComplete,gameStarted:e.gameStarted}}),(function(e){return{onChangeDirection:function(t){e(p(t))}}}))(ce),oe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||I.b,se=Object(I.c)(k,oe(Object(I.a)(L.a)));a.a.render(Object(z.jsx)(C.a,{store:se,children:Object(z.jsx)(ae,{})}),document.getElementById("root")),o()}},[[33,1,2]]]);
//# sourceMappingURL=main.1a777cc7.chunk.js.map